(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/scan/scan"],{"328b":function(e,t,o){},"744f":function(e,t,o){"use strict";(function(e){o("519c");n(o("66fd"));var t=n(o("af6f"));function n(e){return e&&e.__esModule?e:{default:e}}e(t.default)}).call(this,o("543d")["createPage"])},"973d":function(e,t,o){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(o("4795"));function a(e){return e&&e.__esModule?e:{default:e}}function i(e,t,o,n,a,i,r){try{var s=e[i](r),l=s.value}catch(d){return void o(d)}s.done?t(l):Promise.resolve(l).then(n,a)}function r(e){return function(){var t=this,o=arguments;return new Promise((function(n,a){var r=e.apply(t,o);function s(e){i(r,n,a,s,l,"next",e)}function l(e){i(r,n,a,s,l,"throw",e)}s(void 0)}))}}function s(e,t){return p(e)||u(e,t)||d(e,t)||l()}function l(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function d(e,t){if(e){if("string"===typeof e)return c(e,t);var o=Object.prototype.toString.call(e).slice(8,-1);return"Object"===o&&e.constructor&&(o=e.constructor.name),"Map"===o||"Set"===o?Array.from(o):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?c(e,t):void 0}}function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,n=new Array(t);o<t;o++)n[o]=e[o];return n}function u(e,t){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e)){var o=[],n=!0,a=!1,i=void 0;try{for(var r,s=e[Symbol.iterator]();!(n=(r=s.next()).done);n=!0)if(o.push(r.value),t&&o.length===t)break}catch(l){a=!0,i=l}finally{try{n||null==s["return"]||s["return"]()}finally{if(a)throw i}}return o}}function p(e){if(Array.isArray(e))return e}var g={data:function(){return{needLocation:!1,againCLick:!1,noLocation:!1,imgUrl:getApp().globalData.imgUrl,longitude:"00",latitude:"00",qr:"",provinceCode:"",isOnLoad:!1,showPrivacy:!1}},onLoad:function(t){var o=decodeURIComponent(t.q),n=[];if(-1!=o.indexOf("VJ1.TV/")?n=decodeURIComponent(t.q).split("VJ1.TV/")[1].split("/"):-1!=o.indexOf("vj1.tv/")?n=decodeURIComponent(t.q).split("vj1.tv/")[1].split("/"):-1!=o.indexOf("xt.vjifen.com")?-1!=decodeURIComponent(t.q).indexOf("&")?(n[0]=decodeURIComponent(t.q).split("c=")[1].split("&")[0],n[1]=decodeURIComponent(t.q).split("v=")[1]):n=decodeURIComponent(t.q).split("xt.vjifen.com/")[1].split("/"):("",e.showModal({title:"温馨提示",content:"请扫描正确的活动二维码",showCancel:!1,complete:function(t){console.log(t),t.confirm&&e.switchTab({url:"../index/index"})}})),"AH"==n[0].toUpperCase())if(18==n[1].length){var a=n[1][0]+n[1][1]+n[1][3];if("W8W"==a||"Z46"==a||"8C9"==a||"TXA"==a)return e.redirectTo({url:"../result/fail?bizcode=5"})}else if(12==n[1].length){var i=n[1].substr(0,3);if("W8W"==i||"Z46"==i||"8C9"==i||"TXA"==i)return e.redirectTo({url:"../result/fail?bizcode=5"})}console.log(n),n.length>0&&(this.qr=n[1],this.provinceCode=n[0].toUpperCase(),getApp().globalData.provinceCode=n[0].toUpperCase(),this.isOnLoad=!0,this.$Store.commit("setProjectSign",this.provinceCode))},onShow:function(){var t=this;return!!this.isOnLoad&&(console.log(1,this.$Store.state.requestUrl,this.$Store.state.appid,this.$Store.state.payAppid,this.$Store.state.serverName),this.$Store.state.serverName&&this.$Store.state.appid?void(getApp().globalData.vjfOpenid?this.checkProvinceCode().then((function(o){if(console.log("省区关系是否变更",o),!o){getApp().globalData.openid="",getApp().globalData.hbopenid="";try{e.removeStorageSync("openid"),e.removeStorageSync("hbopenid")}catch(n){console.log("removeStorageSync",n)}}if(getApp().globalData.openid){if(!t.qr)return!1;console.log(getApp().globalData.openid),e.getStorage({key:"readPrivacy"}).then((function(e){var o=s(e,2),n=(o[0],o[1]);n?t.$Store.dispatch("getLocation").then((function(e){var o=s(e,2),n=o[0],a=o[1];a?(console.log(a),t.latitude=a.latitude,t.longitude=a.longitude,getApp().globalData.latitude=a.latitude,getApp().globalData.longitude=a.longitude,"U"==t.provinceCode?t.sweepVerify():t.sweep()):(console.log(n),"getLocation:fail authorize no response"==n.errMsg||"getLocation:fail auth deny"==n.errMsg||"getLocation:fail:auth denied"==n.errMsg?t.needLocation=!0:t.noLocation=!0)})):t.showPrivacy=!0}))}else{if(!t.qr)return!1;t.$Store.dispatch("getOpenid").then((function(o){var n=s(o,2),a=n[0],i=n[1];i?(getApp().globalData.openid=i.data.openid,e.getStorage({key:"readPrivacy"}).then((function(e){var o=s(e,2),n=(o[0],o[1]);n?t.$Store.dispatch("getLocation").then((function(e){var o=s(e,2),n=o[0],a=o[1];a?(console.log(a),t.latitude=a.latitude,t.longitude=a.longitude,getApp().globalData.latitude=a.latitude,getApp().globalData.longitude=a.longitude,"U"==t.provinceCode?t.sweepVerify():t.sweep()):(console.log(n),"getLocation:fail authorize no response"==n.errMsg||"getLocation:fail auth deny"==n.errMsg||"getLocation:fail:auth denied"==n.errMsg?t.needLocation=!0:t.noLocation=!0)})):t.showPrivacy=!0}))):(console.log(a),e.navigateTo({url:"../tool/getOpenid/getOpenid?type=openid"}))}))}})):this.$Store.dispatch("getVjfOpenid").then((function(o){var n=s(o,2),a=n[0],i=n[1];i?(getApp().globalData.vjfOpenid=i.data.vjfOpenid,t.checkProvinceCode().then((function(o){if(console.log("省区关系是否变更",o),!o){getApp().globalData.openid="",getApp().globalData.hbopenid="";try{e.removeStorageSync("openid")}catch(a){console.log("removeStorageSync",a)}}if(getApp().globalData.openid){if(!t.qr)return!1;console.log(getApp().globalData.openid),e.getStorage({key:"readPrivacy"}).then((function(e){var o=s(e,2),n=(o[0],o[1]);n?t.$Store.dispatch("getLocation").then((function(e){var o=s(e,2),n=o[0],a=o[1];a?(console.log(a),t.latitude=a.latitude,t.longitude=a.longitude,getApp().globalData.latitude=a.latitude,getApp().globalData.longitude=a.longitude,"U"==t.provinceCode?t.sweepVerify():t.sweep()):(console.log(n),"getLocation:fail authorize no response"==n.errMsg||"getLocation:fail auth deny"==n.errMsg||"getLocation:fail:auth denied"==n.errMsg?t.needLocation=!0:t.noLocation=!0)})):t.showPrivacy=!0}))}else{if(!t.qr)return!1;t.$Store.dispatch("getOpenid").then((function(o){var n=s(o,2),a=n[0],i=n[1];i?(getApp().globalData.openid=i.data.openid,e.getStorage({key:"readPrivacy"}).then((function(e){var o=s(e,2),n=(o[0],o[1]);n?t.$Store.dispatch("getLocation").then((function(e){var o=s(e,2),n=o[0],a=o[1];a?(console.log(5,a),t.latitude=a.latitude,t.longitude=a.longitude,getApp().globalData.latitude=a.latitude,getApp().globalData.longitude=a.longitude,"U"==t.provinceCode?t.sweepVerify():t.sweep()):(console.log("location fail",n),"getLocation:fail authorize no response"==n.errMsg||"getLocation:fail auth deny"==n.errMsg||"getLocation:fail:auth denied"==n.errMsg?t.needLocation=!0:t.noLocation=!0)})):t.showPrivacy=!0}))):(console.log(a),e.navigateTo({url:"../tool/getOpenid/getOpenid?type=openid"}))}))}}))):(console.log(a),e.navigateTo({url:"../tool/getOpenid/getOpenid?type=vjfOpenid"}))}))):(this.qr="",this.provinceCode="",getApp().globalData.provinceCode="",e.showModal({title:"温馨提示",content:"请扫描正确的活动二维码",showCancel:!1,complete:function(t){console.log(t),t.confirm&&e.switchTab({url:"../index/index"})}})))},methods:{readPrivacy:function(){var t=this;this.showPrivacy=!1,e.setStorage({key:"readPrivacy",data:!0}),this.$Store.dispatch("getLocation").then((function(e){var o=s(e,2),n=o[0],a=o[1];a?(console.log(a),t.latitude=a.latitude,t.longitude=a.longitude,getApp().globalData.latitude=a.latitude,getApp().globalData.longitude=a.longitude,"U"==t.provinceCode?t.sweepVerify():t.sweep()):(console.log(n),"getLocation:fail authorize no response"==n.errMsg||"getLocation:fail auth deny"==n.errMsg||"getLocation:fail:auth denied"==n.errMsg?t.needLocation=!0:t.noLocation=!0)}))},toPrivacy:function(){e.navigateTo({url:"../rule/privacy"})},checkProvinceCode:function(){var t=this;return r(n.default.mark((function o(){var a,i;return n.default.wrap((function(o){while(1)switch(o.prev=o.next){case 0:if(a={},getApp().globalData.xcxOpenid){o.next=8;break}return o.next=4,t.$Store.dispatch("getXcxOpenid");case 4:a=o.sent,getApp().globalData.xcxOpenid=a.openid,getApp().globalData.sessionKey=a.session_key,e.setStorage({key:"xcxOpenid",data:a});case 8:return o.next=10,t.$Store.dispatch("getProvinceCode",getApp().globalData.xcxOpenid);case 10:if(i=o.sent,console.log(i),i==t.provinceCode||void 0==t.provinceCode){o.next=18;break}return e.request({url:"".concat(t.$Store.state.isOnline?t.$Store.state.online.sgUrl:t.$Store.state.test.sgUrl,"/api/queryProvinceCode"),method:"GET",data:{xcxopenid:a.openid,provinceCode:t.provinceCode},complete:function(e){console.log("redis",e)}}),e.setStorage({key:"provinceCode",data:t.provinceCode}),o.abrupt("return",!1);case 18:return e.setStorage({key:"provinceCode",data:t.provinceCode}),o.abrupt("return",!0);case 20:case"end":return o.stop()}}),o)})))()},getOpenid:function(){var t=this;return r(n.default.mark((function o(){var a;return n.default.wrap((function(o){while(1)switch(o.prev=o.next){case 0:return o.next=2,t.$Store.dispatch("getXcxOpenid");case 2:return a=o.sent,e.setStorage({key:"xcxOpenid",data:a}),o.abrupt("return",a);case 5:case"end":return o.stop()}}),o)})))()},openset:function(){this.needLocation=!1,e.openSetting()},cancel:function(){console.log("调接口"),this.needLocation=!1,"U"==this.provinceCode?this.sweepVerify():this.sweep()},closeTip:function(){var t=this;e.showModal({title:"温馨提示",content:"开启手机定位有机会获得更大的红包哦！确定不开启手机定位参与本次扫码活动吗？",cancelText:"先开定位",confirmColor:"#808080",confirmText:"直接参与",complete:function(o){console.log(o),o.confirm?(t.noLocation=!1,"U"==t.provinceCode?t.sweepVerify():t.sweep()):e.switchTab({url:"../index/index"})}})},sweep:function(){var t=this;e.showLoading({title:"加载中"}),e.request({url:this.$Store.state.requestUrl+"/sweep/sweepQrcode",method:"POST",data:{openid:getApp().globalData.openid,vjifenOpenid:getApp().globalData.vjfOpenid,paOpenid:"",appletOpenid:getApp().globalData.xcxOpenid,sweepstr:this.qr,longitude:this.longitude,latitude:this.latitude,headimgurl:this.$Store.state.hasUserInfo?this.$Store.state.userInfo.avatarUrl:"",nickname:this.$Store.state.hasUserInfo?this.$Store.state.userInfo.nickName:"",sex:this.$Store.state.hasUserInfo?this.$Store.state.userInfo.gender:"",projectServerName:this.$Store.state.serverName}}).then((function(o){e.hideLoading(),console.log(o);var n=s(o,2),a=(n[0],n[1]);a?0==a.data.result.code?(getApp().globalData.reply=a.data.reply,getApp().globalData.result=a.data.result,getApp().globalData.replyTime=a.data.replyTime,t.$Store.state.haveTel=a.data.reply.phonenum,0==a.data.result.businessCode||11==a.data.result.businessCode?e.redirectTo({url:"../result/getcash?bizcode="+a.data.result.businessCode}):7==a.data.result.businessCode||21==a.data.result.businessCode?e.redirectTo({url:"../result/prize?bizcode="+a.data.result.businessCode}):12==a.data.result.businessCode||13==a.data.result.businessCode?e.redirectTo({url:"../result/getMsg?bizcode="+a.data.result.businessCode}):30==a.data.result.businessCode?e.redirectTo({url:"../result/verification"}):24==a.data.result.businessCode?e.redirectTo({url:"../yylx/yylx"}):e.redirectTo({url:"../result/fail?bizcode="+a.data.result.businessCode})):e.showModal({title:"扫码接口提示",content:"系统开了个小差",showCancel:!1,complete:function(t){t.confirm&&e.switchTab({url:"../index/index"})}}):e.showModal({title:"扫码接口提示",content:"系统繁忙",showCancel:!1,complete:function(t){t.confirm&&e.switchTab({url:"../index/index"})}})}))},sweepVerify:function(){var t=this;e.showLoading({title:"加载中"}),e.request({url:this.$Store.state.requestUrl+"/sweep/sweepVerify",method:"POST",data:{openid:getApp().globalData.openid,vjifenOpenid:getApp().globalData.vjfOpenid,paOpenid:"",appletOpenid:getApp().globalData.xcxOpenid,sweepstr:this.qr,longitude:this.longitude,latitude:this.latitude,headimgurl:this.$Store.state.hasUserInfo?this.$Store.state.userInfo.avatarUrl:"",nickname:this.$Store.state.hasUserInfo?this.$Store.state.userInfo.nickName:"",sex:this.$Store.state.hasUserInfo?this.$Store.state.userInfo.gender:"",projectServerName:this.$Store.state.serverName}}).then((function(o){e.hideLoading(),console.log(o);var n=s(o,2),a=(n[0],n[1]);a?0==a.data.result.code?(getApp().globalData.reply=a.data.reply,getApp().globalData.result=a.data.result,getApp().globalData.replyTime=a.data.replyTime,t.$Store.state.haveTel=a.data.reply.phonenum,0==a.data.result.businessCode||11==a.data.result.businessCode?(getApp().globalData.qr=t.qr,e.redirectTo({url:"../result/getcash?bizcode="+a.data.result.businessCode})):7==a.data.result.businessCode||21==a.data.result.businessCode?e.redirectTo({url:"../result/prize?bizcode="+a.data.result.businessCode}):12==a.data.result.businessCode||13==a.data.result.businessCode?e.redirectTo({url:"../result/getMsg?bizcode="+a.data.result.businessCode}):30==a.data.result.businessCode?e.redirectTo({url:"../result/verification"}):24==a.data.result.businessCode?e.redirectTo({url:"../yylx/yylx"}):e.redirectTo({url:"../result/fail?bizcode="+a.data.result.businessCode})):e.showModal({title:"扫码接口提示",content:"系统开了个小差",showCancel:!1,complete:function(t){t.confirm&&e.switchTab({url:"../index/index"})}}):e.showModal({title:"扫码接口提示",content:"系统繁忙",showCancel:!1,complete:function(t){t.confirm&&e.switchTab({url:"../index/index"})}})}))}}};t.default=g}).call(this,o("543d")["default"])},af6f:function(e,t,o){"use strict";o.r(t);var n=o("fa58"),a=o("babb");for(var i in a)"default"!==i&&function(e){o.d(t,e,(function(){return a[e]}))}(i);o("c7fa");var r,s=o("f0c5"),l=Object(s["a"])(a["default"],n["b"],n["c"],!1,null,"7d49aab8",null,!1,n["a"],r);t["default"]=l.exports},babb:function(e,t,o){"use strict";o.r(t);var n=o("973d"),a=o.n(n);for(var i in n)"default"!==i&&function(e){o.d(t,e,(function(){return n[e]}))}(i);t["default"]=a.a},c7fa:function(e,t,o){"use strict";var n=o("328b"),a=o.n(n);a.a},fa58:function(e,t,o){"use strict";var n,a=function(){var e=this,t=e.$createElement;e._self._c},i=[];o.d(t,"b",(function(){return a})),o.d(t,"c",(function(){return i})),o.d(t,"a",(function(){return n}))}},[["744f","common/runtime","common/vendor"]]]);